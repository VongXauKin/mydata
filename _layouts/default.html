<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | {{ site.title }}</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="{{ site.baseurl }}/styles.css">
</head>
<body>
    
    <div class="container">
        
        <aside class="sidebar">
            <h3 style="padding: 0 20px;"><i class="fa-solid fa-folder-open"></i> Files</h3> 
            
            <button class="add-new-btn">Add New</button> 
            
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="{{ site.baseurl }}/hinh-anh-ki-niem/" {% if page.url contains '/hinh-anh-ki-niem/' %}class="active"{% endif %}>My Files</a></li>
                    <li><a href="{{ site.baseurl }}/documents/">Documents</a></li> 
                    <li><a href="{{ site.baseurl }}/photos/">Photos</a></li>
                    <li><a href="{{ site.baseurl }}/videos/">Videos</a></li>
                </ul>
            </nav>
        </aside>

        <main class="main-content">
            
            <div class="search-bar-top">
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="Tìm kiếm tài liệu & hình ảnh (Omni Search)...">
                    <button id="search-button"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>
            </div>
            
            <div id="results-container"></div>
            
            <div id="content-main">
                
                <div class="header-bar">
                    <div class="title">My Files</div> 
                </div>
                
                <div class="breadcrumb">
                    {% if page.url == site.baseurl or page.url == site.baseurl + '/' %}
                        My Files
                    {% else %}
                        <a href="{{ site.baseurl }}/">My Files</a> / <span>{{ page.title | remove_first: "Mục lục " }}</span>
                    {% endif %}
                </div>

                {{ content }} 
            </div>
        </main>
                <aside class="widget-sidebar">
                    <h3>Widgets</h3>
            
                    <div id="analog-clock-widget">
                        </div>
            
                    <div id="calendar-widget" style="margin-top: 20px;">
                        </div>

                </aside>
    </div>
    
    <footer class="footer">
        <p>&copy; 2025 Data Repository. Powered by Jekyll & GitHub Pages.</p>
    </footer>

    <script src="https://unpkg.com/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>
    <script>
        // Khởi tạo công cụ tìm kiếm
        const sjs = SimpleJekyllSearch({
            searchInput: document.getElementById('search-input'),
            resultsContainer: document.getElementById('results-container'),
            json: '{{ site.baseurl }}/search.json', 
            searchResultTemplate: '<div class="search-result"><h4><a href="{url}">{title}</a></h4><span class="path">{path}</span></div>',
            noResultsText: 'Không tìm thấy kết quả nào.',
            limit: 10,
            fuzzy: false 
        });

        // Thêm logic để ẩn/hiện nội dung chính khi tìm kiếm
        const searchInput = document.getElementById('search-input');
        const contentMain = document.getElementById('content-main');
        const resultsContainer = document.getElementById('results-container');
        
        // Ẩn/Hiện khi gõ
        searchInput.addEventListener('keyup', function() {
            if (searchInput.value.length > 0) {
                contentMain.classList.add('hidden');
            } else {
                contentMain.classList.remove('hidden');
            }
        });

        // Đảm bảo không có kết quả tìm kiếm mờ khi input rỗng
        if (resultsContainer.innerHTML.trim() === '') {
            contentMain.classList.remove('hidden');
        }
    </script>

    <script>
    function updateClock() {
        const now = new Date();
        // Định dạng thời gian
        const timeString = now.toLocaleTimeString('en-US', {hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'});
        
        // Cập nhật cho widget
        const clockWidget = document.getElementById('analog-clock-widget');
        if (clockWidget) {
            clockWidget.innerHTML = `<div style="text-align:center; font-size:1.8em; font-weight:600; color:#333;">${timeString}</div>`;
        }
    }
    setInterval(updateClock, 1000);
    updateClock(); // Chạy lần đầu
    </script>

    function renderCalendar() {
    const now = new Date();
    const currentMonth = now.getMonth();
    const currentYear = now.getFullYear();
    
    // Tạo tiêu đề
    let calendarHTML = `<h4 style="text-align:center; color:#007bff; margin-bottom: 15px;">Tháng ${currentMonth + 1}, ${currentYear}</h4>`;
    
    // Tạo bảng lịch
    calendarHTML += '<table style="width:100%; text-align:center; font-size:0.9em;">';
    calendarHTML += '<thead><tr><th>CN</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th></tr></thead><tbody>';
    
    const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
    let date = 1;
    
    for (let i = 0; i < 6; i++) {
        calendarHTML += '<tr>';
        for (let j = 0; j < 7; j++) {
            if (i === 0 && j < firstDayOfMonth) {
                // Ô trống trước ngày 1
                calendarHTML += '<td></td>';
            } else if (date > daysInMonth) {
                // Ô trống sau ngày cuối cùng
                calendarHTML += '<td></td>';
            } else {
                let cellStyle = '';
                // Highlight ngày hiện tại
                if (date === now.getDate() && currentMonth === now.getMonth() && currentYear === now.getFullYear()) {
                    cellStyle = 'style="background-color:#007bff; color:white; border-radius:50%; font-weight:bold;"';
                }
                // Highlight Chủ Nhật
                else if (j === 0) {
                    cellStyle = 'style="color:red;"';
                }
                
                calendarHTML += `<td ${cellStyle}>${date}</td>`;
                date++;
            }
        }
        calendarHTML += '</tr>';
        if (date > daysInMonth) break;
    }
    
    calendarHTML += '</tbody></table>';
    
    document.getElementById('calendar-widget').innerHTML = calendarHTML;
}

// Chạy hàm lịch cùng với hàm đồng hồ
updateClock(); 
renderCalendar();
    
</body>
</html>
